# Django Model & ORM
## Model
- db의 테이블을 정의하고 데이터를 조작할 수 있는 기능들을 제공
- 테이블 구조를 설계하는 청사진
- articles/models.py에서 model 클래스 작성
  ```python
    class Article(models.Model):
        title = models.CharField(max_length=100)
        content = models.TextField()
    ```


### 실습 -> models.py에서 진행
- artice 앱의 모델을 만들 때 models.Model상속받아 Article클래스 생성
- 클래스 변수가 테이블의 컬럼이 됨.
- 장고에서는 sqlite3를 기본 데이터베이스로 사용 -> 데이터 타입 설정에 융통성이 있다
## Migration
- 모델을 만들고 나서 데이터베이스에 이주시킨다.
- `python manage.py makemigrations` -> 모델의 변경사항을 감지하여 migration 파일 생성
- `python manage.py migrate` -> migration 파일을 실행하여 데이터베이스에 변경사항 적용
- db.sqlite3 파일 내부에 Article 테이블이 만들어짐
- 데이터베이스 보기 위해 확장 프로그램 연결
- `python manage.py create superuser` -> 관리자 계정 생성
- 만들어낸 페이지에서 admin페이지로 이동해서 관리자 계정으로 로그인 -> 데이터 관리 가능
- articles 앱의 admin.py에서 Article 모델 등록
  ```python
    from django.contrib import admin
    from .models import Article

    admin.site.register(Article)
  ```
### 모델을 수정한 경우
- 모델 수정 후 `python manage.py makemigrations` -> 모델의 변경사항을 감지하여 migration 파일 생성
- created_at, updated_at 필드 추가
  ```python
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)
  ```
- makemigrations 실행하면 기본값이 없어서 안된다고 함.
- 결정 안해서 null로 채워지면 결측치가 됨
- 1번 기본값 일괄설정 결정하면 적절한 선택지 제공, 엔터 누르면 그대로 적용됨
- 2번은 대화에서 나간 후 직접 수정
- 디폴트 설정 후 `python manage.py migrate` -> 데이터베이스에 변경사항 적용
## Admin site
- 관리자 페이지.(장고에서 제공)

### 파이썬 코드로 사용자가 데이터 생성할 수 있게 하기
- views에서 post 요청 만들기
- article.save() -> 데이터베이스에 저장
- 파이썬은 sql문을 안써도 되도록 queryset API 제공
## ORM(Object-Relational Mapping)
- 객체 지향 프로그래밍 언어를 사용하여 호환되지 않는 유형의 시스템 간에 데이터 변환하는 기술
### QuerySet API
- orm에서 데이터를 검색, 필터링, 정렬 및 그룹화 하는 데 사용하는 도구
- api 사용하여 sql문 없이 python 코드로 데이터 처리
- 구문: Article.objects.all() -> Article 테이블의 모든 레코드 반환
- 놓친 부분 많으니 다시보기
- id값은 장고에서 기본적으로 정수값으로 만들어줌
- get방식으로 조회할때는 unique한 값을 조회해야함. -> id값은 유니크하므로 get방식으로 조회 가능
- edit을 할거면 put방식, get을 이용해 수정할 글을 가져와서 수정 후 save()로 저장
## Serializer
- Serialization : 여러 시스템에서 활용하기 위해 데이터 구조나 객체 상태를 나중에 재구성할 수 있는 포맷으로 변환하는 과정
  - 어떤 언어나 환경에서도 나중에 다시 쉽게 사용할 수 있는 포맷으로 변환하는 과정
### Serializer Class
- Serializer : Serialization을 진행하여 Serialized data를 반환해주는 클래스
- json이나 xml과 같은 포맷으로 데이터를 변환하여 API 응답으로 반환하는 데 사용
- 실습코드 02_SERIALIZER_SKELETON 참조
### 부분 업데이트
- 전체 업데이트 : PUT 방식, 모든 필드 업데이트
- 부분 업데이트 : PATCH 방식, 일부 필드 업데이트
- serializer에서 partial=True 옵션 사용하여 부분 업데이트 허용
- 예시: `serializer = ArticleSerializer(article, data=request.data, partial=True)`
- 사용자가 보낸 메소드가 문제가 아님, 백엔드 측에서 그에 맞는 메소드를 직접 구현해야 함. 보내진 건 그냥 보내진 키값같은거.